SELECT   cic.FACILITYID,
         i.STOCK_FAC,
         cic.CUSTOMER_NBR_STND,
         case cic.FACILITYID 
              when '086' then 'SPDPD' 
              else cic.FACILITYID 
         end vendor_code,
         current timestamp catalog_effective_date_time,
         asin.LU_CODE asin,
         i.UPC_UNIT_CD unit_upc,
         i.UPC_CASE_CD case_upc,
         i.GTIN,
         i.ITEM_NBR_HS vendor_sku,
         trim(i.BRAND) || ' ' || trim(i.RETAIL_ITEM_DESC) || ' ' || trim(i.ITEM_SIZE) || ' ' || trim(i.ITEM_SIZE_UOM) item_name,
         i.BRAND brand,
         v.MASTER_VENDOR_DESC manufacturer,
         v.VENDOR_NAME supplier_Name,
         case 
              when i.BILLING_STATUS_BACKSCREEN in ('A', 'W') then case 
                                                                       when i.AVAILABILITY_DATE > current date then 'TEMP_OUT_OF_STOCK' 
                                                                       when i.RE_AVAILABLE_DATE > current date then 'TEMP_OUT_OF_STOCK' 
                                                                       else 'AVAILABLE' 
                                                                  end 
              when i.BILLING_STATUS_BACKSCREEN = 'P' then 'NOT IN STOCK YET' 
              else 'PERM_OUT_OF_STOCK' 
         end availability_status,
         CASE 
              WHEN right(cast(round(cast(cast(cic.BURDENED_COST_CASE_AMT as decimal(7,3)) / cast(i.PACK_CASE as decimal(7,3)) as decimal(7,3)),3) as decimal(7,3)), 1) > 0 THEN cast(round(cast(cast(cic.BURDENED_COST_CASE_AMT as decimal(7,3)) / cast(i.PACK_CASE as decimal(7,3)) as decimal(7,3)),3) as decimal(6,2)) + 0.01 
                                                                                                                                                                                                                                                                    Else cast(cic.BURDENED_COST_CASE_AMT / i.PACK_CASE as decimal(6,2)) 
                                                                                                                                                                                                                                                                                                                  END item_cost_price,
         i.PACK_CASE case_pack_quantity,
         cic.BURDENED_COST_CASE_AMT case_pack_cost_price,
         case i.WAREHOUSE_CODE 
              when '01' then 'Chilled' 
              when '02' then 'Chilled' 
              when '08' then 'Chilled' 
              when '07' then 'Frozen' 
              else 'Ambient' 
         end temp_type,
         i.RET_UNIT_SIZE,
         i.RET_UNIT_DESC,
         (case i.CODE_DATE_FLAG when 'Y' then 'Shelf Life' else 'Does Not Expire' end) expiration_type,
         (case i.CODE_DATE_FLAG when 'Y' then i.SHELF_LIFE else 365 end) shelf_life,
         i.MERCH_DEPT_DESC,
         i.MERCH_GRP_DESC,
         i.MERCH_CAT_DESC,
         i.MERCH_CLASS_DESC,
         cic.BURDENED_COST_CASE_AMT case_Pack_Cost_burdened,
         i.PURCH_STATUS,
         i.BILLING_STATUS,
         i.BILLING_STATUS_BACKSCREEN,
         i.NATAG_MAINT_DATE,
         i.AVAILABILITY_DATE,
         i.RE_AVAILABLE_DATE,
         case i.CORP_RES 
              when lpad(trim(cic.CORP_SWAT),3,'0') then 'Y' 
              when '000' then 'Y' 
              else 'N' 
         end CORP_AUTH_FLG,
         i.INSITE_FLG,
         i.ITEM_TYPE_CD,
         case 
              when cid.ITEM_AUTH_CD is null then 'Y' 
              else case 
                        when cid.ITEM_AUTH_CD = 'Y' then 'Y' 
                        else 'N' 
                   end 
         end ITEM_AUTH_FLG,
         case 
              when i.PRIVATE_LABEL_KEY = vwcpb.PRIV_BRAND_KEY then 'Y' 
              else case 
                        when i.PRIVATE_LABEL_KEY is null then 'Y' 
                        else 'N' 
                   end 
         end PRIVATE_BRAND_AUTH_FLG,
         i.MERCH_DEPT
FROM     TABLE( SELECT FACILITYID, CUSTOMER_NBR_STND, BURDENED_COST_FLG, CORP_SWAT, ITEM_NBR_HS, START_DATE, END_DATE_REAL, BURDENED_COST_CASE_AMT, BURDENED_COST_UNIT_AMT FROM CRMADMIN.V_WEB_CUSTOMER_ITEM_COST WHERE FACILITYID = '086' and CUSTOMER_NBR_STND = 634001 and MASTER_ITEM_FLG = 'Y' AND current date between START_DATE and END_DATE_REAL ) CIC 
         inner join CRMADMIN.T_WHSE_ITEM i on i.FACILITYID = cic.FACILITYID and i.ITEM_NBR_HS = cic.ITEM_NBR_HS 
         inner join CRMADMIN.T_WHSE_VENDOR v on i.FACILITYID = v.FACILITYID and i.VENDOR_NBR = v.VENDOR_NBR 
         inner join CRMADMIN.V_WEB_CUSTOMER_MDSE_DEPT cmd on i.FACILITYID = cmd.FACILITYID and cmd.CUSTOMER_NBR_STND = cic.CUSTOMER_NBR_STND and i.MERCH_DEPT = cmd.MDSE_DEPT_CD 
         left outer join CRMADMIN.V_WEB_CUSTOMER_PRVT_BRAND vwcpb on i.FACILITYID = vwcpb.FACILITYID and vwcpb.CUSTOMER_NBR_STND = cic.CUSTOMER_NBR_STND and i.PRIVATE_LABEL_KEY = vwcpb.PRIV_BRAND_KEY 
         left outer join CRMADMIN.T_WHSE_ITEM_AUTH cid on cic.FACILITYID = cid.FACILITYID and cid.CUSTOMER_NBR_STND = cic.CUSTOMER_NBR_STND and cic.ITEM_NBR_HS = cid.ITEM_NBR_HS and (cid.EXP_DATE is null or cid.EXP_DATE >= current date) and cid.ITEM_ACTIVE_FLG = 'Y' and cid.ITEM_AUTH_CD <> 'Y' 
         left outer join CRMADMIN.V_AMZ_ASIN asin on i.ROOT_ITEM_NBR = asin.ROOT_ITEM_NBR and i.LV_ITEM_NBR = asin.LV_ITEM_NBR
WHERE    (i.ITEM_TYPE_CD = 'R'
     OR  (i.ITEM_TYPE_CD = 'I'
        AND asin.LU_CODE is not null))
AND      i.PURCH_STATUS in ('A','S','D')
AND      i.ITEM_NBR_HS = '0058255'
;
SELECT   FACILITYID,
         CUSTOMER_NBR_STND,
         BURDENED_COST_FLG,
         CORP_SWAT,
         ITEM_NBR_HS,
         START_DATE,
         END_DATE_REAL,
         BURDENED_COST_CASE_AMT,
         BURDENED_COST_UNIT_AMT
FROM     CRMADMIN.V_WEB_CUSTOMER_ITEM_COST
WHERE    FACILITYID = '086'
--AND      CUSTOMER_NBR_STND = 634001
AND      MASTER_ITEM_FLG = 'Y'
AND      current date between START_DATE and END_DATE_REAL
AND      ITEM_NBR_HS = '0058255';


select * from CRMADMIN.T_WHSE_ITEM where facilityid = '086' AND      ITEM_NBR_HS = '0058255';
-- in ('0048751', '0048777', '0051698', '0052001', '0052019', '0052027', '0052035', '0052050', '0052068', '0052076', '0052084', '0052092', '0052100', '0052209', '0052217', '0052233', '0052241', '0052274', '0052290', '0053272', '0053280', '0053298', '0053306', '0053314', '0053322', '0053348', '0053363', '0056127', '0056259', '0056333', '0056481', '0056523', '0056622', '0056663', '0058255', '0059220', '0059238', '0059246', '0059345', '0059352', '0059477', '0060343', '0094458', '0103317', '0103465', '0103507', '0103515', '0104430', '0105098', '0105296', '0109504', '0109538', '0109678', '0109686', '0109710', '0109777', '0109843', '0109892', '0109934', '0109942', '0109959', '0110064', '0110072', '0110148', '0110221', '0110247', '0110262', '0110437', '0110445', '0110460', '0110486', '0110494', '0113464', '0113506', '0113746', '0113928', '0113985', '0114553', '0114918', '0115238', '0115451', '0115774', '0115923', '0117341', '0120394', '0123539', '0124008', '0124040', '0124057', '0124206', '0125781', '0125807', '0125815', '0125823', '0157743', '0158519', '0159830', '0161562', '0197574', '0197681', '0203893', '0203927', '0213843', '0231944', '0231993', '0235960', '0278275', '0278283', '0278291', '0278309', '0278341', '0278846', '0278861', '0279711', '0279737', '0282822', '0287953', '0311399', '0311407', '0311423', '0312488', '0321232', '0327155', '0380444', '0380469', '0380485', '0384164', '0390781', '0390872', '0390963', '0390989', '0391011', '0391045', '0391128', '0391151', '0391177', '0391185', '0391193', '0391201', '0391219', '0391235', '0391284', '0392688', '0392837', '0393553', '0393843', '0393876', '0393884', '0393975', '0394080', '0394098', '0394189', '0397521', '0397570', '0405761', '0406488', '0446377', '0461202', '0494542', '0511899', '0590976', '0591222', '0648378', '0648402', '0668608', '0690743', '0690768', '0690818', '0691071', '0691139', '0706002', '0730010', '0814566', '0814590', '0814608', '0892968', '0292227')
;

--AND      i.ITEM_NBR_HS in ('0007872', '0007906', '0036954', '0052001', '0052019', '0052050', '0052068', '0052076', '0052092', '0052100', '0052209', '0052290', '0053298', '0053314', '0053322', '0053330', '0053363', '0056481', '0059477', '0060343', '0062372', '0065383', '0089482', '0089524', '0103317', '0121749', '0145789', '0145805', '0145813', '0145862', '0149724', '0150144', '0154658', '0213868', '0213876', '0237222', '0298018', '0368530', '0415273', '0719666', '0866814', '0924530');



--AND      i.ITEM_NBR_HS in ('0002980', '0003194', '0006700', '0007641', '0007690', '0007740', '0007765', '0007781', '0007799', '0007807', '0007815', '0007831', '0007849', '0007906', '0007922', '0007930', '0007955', '0007971', '0007989', '0007997', '0010389', '0014746', '0015446', '0015487', '0015594', '0015610', '0015628', '0015685', '0015859', '0018200', '0018226', '0020750', '0020891', '0021113', '0021238', '0023382', '0023408', '0027060', '0030312', '0030536', '0030569', '0030619', '0030643', '0030650', '0032409', '0035766', '0036954', '0036962', '0037002', '0038752', '0040683', '0047654', '0047852', '0048405', '0048751', '0048777', '0049403', '0050054', '0050229', '0050245', '0050419', '0050427', '0050914', '0050989', '0051011', '0051078', '0051482', '0051698', '0052001', '0052019', '0052027', '0052035', '0052050', '0052068', '0052076', '0052084', '0052092', '0052100', '0052209', '0052217', '0052233', '0052241', '0052274', '0052290', '0052977', '0053157', '0053272', '0053280', '0053298', '0053306', '0053314', '0053322', '0053330', '0053348', '0053363', '0053439', '0056127', '0056259', '0056333', '0056481', '0056523', '0056622', '0056663', '0059220', '0059238', '0059246', '0059345', '0059352', '0059477', '0060343', '0060863', '0062372', '0062406', '0062430', '0062448', '0062570', '0062687', '0064675', '0065300', '0065375', '0065383', '0065417', '0065425', '0065516', '0065557', '0065607', '0065748', '0065755', '0065789', '0065797', '0065805', '0065813', '0066050', '0066076', '0066084', '0066241', '0066258', '0066266', '0066290', '0066316', '0066589', '0066597', '0066605', '0066621', '0066654', '0066746', '0066753', '0066787', '0066811', '0066829', '0066852', '0069666', '0069740', '0070763', '0070896', '0074013', '0083857', '0083873', '0083915', '0083956', '0083980', '0084004', '0087213', '0087262', '0087882', '0089482', '0089524', '0089540', '0089623', '0089664', '0089839', '0094219', '0096768', '0099770', '0101113', '0103317', '0103465', '0103507', '0103515', '0104166', '0104190', '0104430', '0105098', '0105296', '0109504', '0109538', '0109678', '0109686', '0109710', '0109777', '0109843', '0109892', '0109934', '0109942', '0109959', '0110064', '0110072', '0110148', '0110163', '0110221', '0110247', '0110262', '0110437', '0110460', '0110486', '0110494', '0112235', '0113464', '0113506', '0113746', '0113928', '0113985', '0114553', '0114918', '0115238', '0115451', '0115683', '0115774', '0115923', '0120394', '0121616', '0121749', '0121780', '0121814', '0121855', '0121947', '0121962', '0122028', '0122044', '0122341', '0122440', '0122481', '0122507', '0122697', '0122747', '0122762', '0123257', '0123539', '0124008', '0124040', '0124057', '0124164', '0124206', '0124230', '0124602', '0125179', '0125310', '0125328', '0125781', '0125807', '0125815', '0125823', '0127548', '0130518', '0130583', '0130807', '0130815', '0130823', '0130831', '0130906', '0131011', '0131029', '0131045', '0131227', '0131235', '0131276', '0131292', '0131383', '0131391', '0134791', '0136630', '0139998', '0141309', '0142349', '0142661', '0142760', '0144493', '0144931', '0144949', '0145722', '0145789', '0145805', '0145813', '0145839', '0145847', '0145862', '0147090', '0147280', '0147314', '0147363', '0147421', '0147447', '0147454', '0147629', '0147819', '0147827', '0147835', '0147876', '0147918', '0148122', '0149658', '0149666', '0149724', '0149815', '0149971', '0150003', '0150045', '0150052', '0150128', '0150144', '0150151', '0150201', '0150342', '0150383', '0150433', '0150466', '0150482', '0150854', '0151076', '0151126', '0151167', '0151175', '0151191', '0151209', '0151225', '0151373', '0151407', '0151449', '0151530', '0151605', '0152793', '0154658', '0156273', '0156364', '0156505', '0156513', '0156547', '0156885', '0157024', '0157172', '0157248', '0157263', '0157479', '0157743', '0158519', '0158782', '0159749', '0159830', '0161406', '0161430', '0161455', '0161463', '0161562', '0162859', '0162974', '0163014', '0163048', '0163055', '0163188', '0163196', '0163790', '0164103', '0165555', '0165563', '0165571', '0165928', '0166454', '0166793', '0170365', '0170894', '0171041', '0179168', '0179317', '0179325', '0179333', '0179366', '0179382', '0179432', '0179440', '0179457', '0179473', '0179531', '0184473', '0185421', '0187021', '0188532', '0189076', '0189415', '0189431', '0189449', '0189480', '0189936', '0189977', '0193813', '0194068', '0197574', '0197681', '0203893', '0203927', '0207860', '0213868', '0213876', '0213918', '0216135', '0216150', '0216275', '0216358', '0216564', '0217083', '0217091', '0220160', '0227272', '0227314', '0227322', '0229203', '0229518', '0229674', '0229708', '0229948', '0230938', '0231944', '0231993', '0233916', '0234013', '0234096', '0234120', '0234799', '0234823', '0234831', '0234971', '0235960', '0236695', '0237214', '0237222', '0237271', '0237289', '0238782', '0238923', '0239012', '0239624', '0239947', '0239970', '0241190', '0241240', '0241265', '0244160', '0244251', '0244277', '0247023', '0257311', '0257360', '0278275', '0278283', '0278291', '0278309', '0278341', '0278846', '0278861', '0279711', '0279737', '0282822', '0284224', '0296491', '0296582', '0296673', '0296699', '0296723', '0297671', '0297853', '0297952', '0297978', '0298018', '0308601', '0312413', '0312488', '0313049', '0319236', '0321232', '0321315', '0321794', '0323543', '0326785', '0326926', '0327155', '0327478', '0327643', '0328195', '0329714', '0329946', '0331553', '0332254', '0332262', '0332296', '0332338', '0332353', '0332528', '0332874', '0332916', '0333039', '0333328', '0333401', '0333427', '0333435', '0333591', '0333617', '0334169', '0334961', '0335224', '0335505', '0336073', '0336800', '0336859', '0337410', '0337832', '0337865', '0343103', '0343210', '0343277', '0343350', '0343376', '0343400', '0350215', '0353680', '0358358', '0358473', '0358515', '0360792', '0360933', '0361154', '0361493', '0361964', '0362020', '0368423', '0368449', '0368456', '0368498', '0368506', '0368514', '0368530', '0370825', '0371013', '0372052', '0375931', '0380444', '0380469', '0380485', '0384164', '0388355', '0390781', '0390872', '0390963', '0390989', '0391011', '0391045', '0391128', '0391151', '0391177', '0391185', '0391193', '0391201', '0391219', '0391235', '0391284', '0392688', '0392837', '0393553', '0393876', '0393884', '0394080', '0394098', '0394189', '0397521', '0397570', '0405761', '0405910', '0406488', '0412239', '0412627', '0415273', '0415323', '0421461', '0421818', '0423251', '0435586', '0437863', '0440529', '0440685', '0441790', '0442855', '0443242', '0443606', '0443663', '0446377', '0452144', '0461202', '0462853', '0464412', '0464461', '0466888', '0468157', '0469114', '0477273', '0479048', '0487843', '0508267', '0511295', '0511303', '0511899', '0533554', '0552794', '0576108', '0588863', '0590976', '0591222', '0606665', '0607358', '0618355', '0623413', '0626119', '0636233', '0637934', '0641472', '0646927', '0647081', '0648048', '0668608', '0670273', '0670323', '0671446', '0671495', '0671610', '0671875', '0671933', '0672402', '0672410', '0672451', '0672717', '0672964', '0677906', '0679928', '0681536', '0690743', '0690768', '0690818', '0691071', '0691139', '0691840', '0695148', '0706002', '0719666', '0719955', '0730010', '0744011', '0754796', '0754804', '0754820', '0755702', '0755744', '0756221', '0757153', '0757245', '0758706', '0769174', '0769323', '0772129', '0779520', '0780684', '0788323', '0788984', '0789040', '0796045', '0810994', '0828277', '0828350', '0853010', '0853176', '0856971', '0858001', '0866814', '0892968', '0916395', '0918623', '0924530', '0929497', '0936237');


;
SELECT   VENDOR_CODE,
         CATALOG_EFFECTIVE_DATE_TIME,
         ASIN,
         UNIT_UPC,
         CASE_UPC,
         GTIN,
         VENDOR_SKU,
         REPLACE(ITEM_NAME, '"', 'in'),
         BRAND,
         MANUFACTURER,
         SUPPLIER_NAME,
         AVAILABILITY_STATUS,
         ITEM_COST_PRICE,
         CASE_PACK_QUANTITY,
         CASE_PACK_COST_PRICE,
         TEMP_TYPE,
         RET_UNIT_SIZE,
         RET_UNIT_DESC,
         EXPIRATION_TYPE,
         SHELF_LIFE,
         MERCH_DEPT_DESC,
         MERCH_GRP_DESC,
         MERCH_CAT_DESC,
         MERCH_CLASS_DESC,
         PURCH_STATUS,
         BILLING_STATUS
FROM     CRMADMIN.V_AMZ_CATALOG_FEED
WHERE    CORP_AUTH_FLG = 'Y'
AND      ITEM_AUTH_FLG = 'Y'
AND      PRIVATE_BRAND_AUTH_FLG = 'Y'
AND      vendor_code = 'SPDPD'
AND      VENDOR_SKU in ('0048751', '0048777', '0051698', '0052001', '0052019', '0052027', '0052035', '0052050', '0052068', '0052076', '0052084', '0052092', '0052100', '0052209', '0052217', '0052233', '0052241', '0052274', '0052290', '0053272', '0053280', '0053298', '0053306', '0053314', '0053322', '0053348', '0053363', '0056127', '0056259', '0056333', '0056481', '0056523', '0056622', '0056663', '0058255', '0059220', '0059238', '0059246', '0059345', '0059352', '0059477', '0060343', '0094458', '0103317', '0103465', '0103507', '0103515', '0104430', '0105098', '0105296', '0109504', '0109538', '0109678', '0109686', '0109710', '0109777', '0109843', '0109892', '0109934', '0109942', '0109959', '0110064', '0110072', '0110148', '0110221', '0110247', '0110262', '0110437', '0110445', '0110460', '0110486', '0110494', '0113464', '0113506', '0113746', '0113928', '0113985', '0114553', '0114918', '0115238', '0115451', '0115774', '0115923', '0117341', '0120394', '0123539', '0124008', '0124040', '0124057', '0124206', '0125781', '0125807', '0125815', '0125823', '0157743', '0158519', '0159830', '0161562', '0197574', '0197681', '0203893', '0203927', '0213843', '0231944', '0231993', '0235960', '0278275', '0278283', '0278291', '0278309', '0278341', '0278846', '0278861', '0279711', '0279737', '0282822', '0287953', '0311399', '0311407', '0311423', '0312488', '0321232', '0327155', '0380444', '0380469', '0380485', '0384164', '0390781', '0390872', '0390963', '0390989', '0391011', '0391045', '0391128', '0391151', '0391177', '0391185', '0391193', '0391201', '0391219', '0391235', '0391284', '0392688', '0392837', '0393553', '0393843', '0393876', '0393884', '0393975', '0394080', '0394098', '0394189', '0397521', '0397570', '0405761', '0406488', '0446377', '0461202', '0494542', '0511899', '0590976', '0591222', '0648378', '0648402', '0668608', '0690743', '0690768', '0690818', '0691071', '0691139', '0706002', '0730010', '0814566', '0814590', '0814608', '0892968', '0292227')
;


--('0007872', '0007906', '0036954', '0052001', '0052019', '0052050', '0052068', '0052076', '0052092', '0052100', '0052209', '0052290', '0053298', '0053314', '0053322', '0053330', '0053363', '0056481', '0059477', '0060343', '0062372', '0065383', '0089482', '0089524', '0103317', '0121749', '0145789', '0145805', '0145813', '0145862', '0149724', '0150144', '0154658', '0213868', '0213876', '0237222', '0298018', '0368530', '0415273', '0719666', '0866814', '0924530');