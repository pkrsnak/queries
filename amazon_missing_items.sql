SELECT   i.FACILITYID,
         i.ITEM_NBR_HS,
         i.ITEM_DESCRIP,
         i.PACK_CASE,
         i.ITEM_SIZE,
         i.ITEM_SIZE_UOM,
         i.PURCH_STATUS,
         i.BILLING_STATUS_BACKSCREEN,
         i.NATAG_MAINT_DATE,
         a.LU_CODE asin,
         i.CORP_RES,
         cic.BURDENED_COST_CASE_AMT,
         cmd.MDSE_DEPT_CD,
         vwcpb.PRIV_BRAND_KEY,
         cid.ITEM_AUTH_CD,
         case i.CORP_RES 
              when lpad(trim(cic.CORP_SWAT),3,'0') then 'Y' 
              when '000' then 'Y' 
              else 'N' 
         end CORP_AUTH_FLG,
         i.INSITE_FLG,
         i.ITEM_TYPE_CD,
         case 
              when cid.ITEM_AUTH_CD is null then 'Y' 
              else case 
                        when cid.ITEM_AUTH_CD = 'Y' then 'Y' 
                        else 'N' 
                   end 
         end ITEM_AUTH_FLG,
         case 
              when i.PRIVATE_LABEL_KEY = vwcpb.PRIV_BRAND_KEY then 'Y' 
              else case 
                        when i.PRIVATE_LABEL_KEY is null then 'Y' 
                        else 'N' 
                   end 
         end PRIVATE_BRAND_AUTH_FLG
FROM     CRMADMIN.T_WHSE_ITEM i 
         left outer join CRMADMIN.V_AMZ_ASIN a on a.ROOT_ITEM_NBR = i.ROOT_ITEM_NBR and a.LV_ITEM_NBR = i.LV_ITEM_NBR 
         left outer join CRMADMIN.V_WEB_CUSTOMER_PRVT_BRAND vwcpb on i.FACILITYID = vwcpb.FACILITYID and vwcpb.CUSTOMER_NBR_STND = 634001 and i.PRIVATE_LABEL_KEY = vwcpb.PRIV_BRAND_KEY 
         left outer join TABLE( SELECT A.FACILITYID, A.CUSTOMER_NBR_STND, A.BURDENED_COST_FLG, A.CORP_SWAT, A.ITEM_NBR_HS, START_DATE, END_DATE_REAL, BURDENED_COST_CASE_AMT, UNBURDENED_COST_CASE_AMT, BURDENED_COST_CASE_NET_AMT, UNBURDENED_COST_CASE_NET_AMT, OI_ALLOWANCE_START_DATE, OI_ALLOWANCE_END_DATE, OI_ALLOWANCE_AMT, PA_ALLOWANCE_START_DATE, PA_ALLOWANCE_END_DATE, PA_ALLOWANCE_AMT FROM CRMADMIN.V_WEB_CUSTOMER_ITEM_COST A WHERE A.MASTER_ITEM_FLG = 'Y' AND A.CUSTOMER_NBR_STND = 634001 AND current date between A.START_DATE and A.END_DATE_REAL ) cic on cic.FACILITYID = i.FACILITYID and cic.ITEM_NBR_HS = i.ITEM_NBR_HS 
         left outer join CRMADMIN.V_WEB_CUSTOMER_MDSE_DEPT cmd on i.FACILITYID = cmd.FACILITYID and cmd.CUSTOMER_NBR_STND = 634001 and i.MERCH_DEPT = cmd.MDSE_DEPT_CD 
         left outer join CRMADMIN.T_WHSE_ITEM_AUTH cid on i.FACILITYID = cid.FACILITYID and cid.CUSTOMER_NBR_STND = 634001 and i.ITEM_NBR_HS = cid.ITEM_NBR_HS and (cid.EXP_DATE is null or cid.EXP_DATE >= current date) and cid.ITEM_ACTIVE_FLG = 'Y' and cid.ITEM_AUTH_CD <> 'Y'
WHERE    i.FACILITYID = '015'
AND      i.ITEM_NBR_HS in ('0046193', '0046276', '0046292', '0046474', '0053637', '0053660', '0056523', '0057943', '0069153', '0077321', '0083576', '0083626', '0084186', '0084327', '0084780', '0085670', '0086140', '0091496', '0091579', '0092163', '0092312', '0092346', '0093559', '0097204', '0098376', '0098590', '0099507', '0108985', '0112946', '0115360', '0119719', '0122127', '0122440', '0122515', '0122911', '0125179', '0125310', '0127639', '0128975', '0131243', '0131284', '0137570', '0156125', '0158493', '0158634', '0161604', '0162578', '0166694', '0167528', '0169557', '0172239', '0172981', '0174300', '0175067', '0175182', '0175422', '0181974', '0182055', '0182451', '0182519', '0183525', '0184499', '0185165', '0185553', '0185967', '0186452', '0187096', '0189167', '0196923', '0199919', '0211417', '0211870', '0219550', '0220202', '0221754', '0226902', '0227348', '0228023', '0228064', '0231290', '0232082', '0232173', '0233460', '0235358', '0235408', '0237610', '0238097', '0240804', '0240945', '0241141', '0241422', '0241570', '0241778', '0242883', '0243121', '0246454', '0247668', '024786 ', '0249086', '0249102', '0252833', '0253013', '0256479', '0263426', '0267112', '0268128', '0269746', '0277699', '0277756', '0282566', '0283259', '0284182', '0285593', '0286336', '0286690', '0288985', '0301168', '0302604', '0302992', '0303214', '0303990', '0304014', '0304279', '0305540', '0305987', '0307959', '0317214', '0317669', '0317701', '03178  ', '0320051', '0321836', '0324764', '0326017', '0326439', '0328559', '0328732', '0329169', '0329854', '0332353', '0333799', '0337956', '0339762', '0340976', '0342667', '0344507', '0345116', '0349167', '0349613', '0353763', '0355230', '0355958', '0355966', '0356006', '0356014', '0358184', '0358325', '0360073', '0360081', '0363416', '0363846', '0365395', '0365825', '0365882', '0366237', '0366575', '0370221', '0372417', '0372904', '0380261', '0381467', '0382531', '0387019', '0387167', '0391698', '0392993', '0393389', '0393892', '0395293', '0396457', '0412445', '0425777', '0425900', '0427633', '0430991', '0431486', '0435917', '0435933', '0437244', '0438572', '0440453', '0441196', '0441279', '0443663', '0444547', '0446195', '0446716', '0447425', '0448316', '0451500', '0451732', '0451849', '0451989', '0453647', '0454009', '0456178', '0458208', '0460550', '0460881', '0462879', '0463364', '0465534', '0465609', '0467670', '0469742', '0470955', '0471441', '0472845', '0475830', '0476093', '0476739', '0477190', '0479444', '0483289', '0484527', '0485110', '0485870', '0486274', '0486498', '0486803', '0488999', '0489310', '0489807', '0490128', '0491712', '0491795', '0492066', '0492579', '0492744', '0492777', '0493213', '0493965', '0494468', '0496117', '0496414', '0497339', '0497511', '0498725', '050245 ', '0504142', '0506998', '0508069', '0508721', '0512871', '0512947', '0513267', '0514380', '0515171', '0515817', '0516351', '0518464', '0519355', '0519694', '0519884', '0521351', '0522243', '0525766', '0525782', '0527051', '0528448', '0528497', '0529933', '0536532', '0536607', '0536649', '0537100', '0538066', '0538140', '0538496', '0539635', '0541870', '0542449', '0543579', '0544106', '0544999', '0545285', '0546721', '0546861', '0548222', '0548842', '0550194', '0550459', '0553198', '0555375', '0555607', '0556068', '0556720', '0556803', '0559914', '0560045', '0560631', '0560722', '0561175', '0561522', '0561589', '0563106', '0563734', '0563908', '0564013', '0564054', '0565630', '0565879', '0566216', '0567008', '0568642', '0568733', '0571497', '0576512', '0576603', '0583831', '0583971', '0584755', '0586529', '0587550', '0595900', '0596767', '0598573', '0606079', '0607176', '0608349', '0609289', '0611822', '0612416', '0612721', '0612788', '0613166', '0614859', '0616359', '0617894', '0625723', '0626705', '0631556', '0636795', '0637181', '0640649', '0648352', '0648386', '0650465', '0651976', '0656066', '0656553', '0656785', '0656884', '0658021', '0658310', '0661538', '0661975', '0663146', '0663237', '0672766', '0672832', '0673418', '0674630', '0678094', '0679894', '0681452', '0683417', '0684217', '0684670', '0684696', '0685644', '0686634', '0686709', '0687418', '0688119', '0688531', '0688911', '0689141', '0689414', '0689877', '0689893', '0689943', '0690081', '0691055', '0691071', '0692723', '0697276', '0698555', '0698563', '0698712', '0701730', '0702548', '0704361', '0706663', '0716415', '0716571', '0716688', '0718296', '0721605', '0722108', '0729889', '0731026', '0736231', '0736272', '0736306', '0738823', '0740464', '0740902', '0743401', '0744268', '0747121', '0749366', '0753723', '0753962', '0754085', '0754150', '0754309', '0754499', '0754598', '0755702', '0761189', '0763094', '0763177', '0764019', '0765040', '0767723', '0771451', '0774224', '0782045', '0787903', '0788398', '0794602', '0798660', '0811042', '0811703', '0811760', '0812875', '0815134', '0827428', '0828129', '0829036', '0829150', '0840207');

SELECT   case cic.FACILITYID 
     when '054' then '040' 
     else cic.FACILITYID 
end FACILITYID,
         i.STOCK_FAC,
         cic.CUSTOMER_NBR_STND,
         case cic.FACILITYID 
              when '015' then 'F3SPC' 
              else cic.FACILITYID 
         end vendor_code,
         current timestamp catalog_effective_date_time,
         asin.LU_CODE asin,
         i.UPC_UNIT_CD unit_upc,
         i.UPC_CASE_CD case_upc,
         i.GTIN,
         i.ITEM_NBR_HS vendor_sku,
         trim(i.BRAND) || ' ' || trim(i.RETAIL_ITEM_DESC) || ' ' || trim(i.ITEM_SIZE) || ' ' || trim(i.ITEM_SIZE_UOM) item_name,
         i.BRAND brand,
         v.MASTER_VENDOR_DESC manufacturer,
         v.VENDOR_NAME supplier_Name,
         case 
              when i.BILLING_STATUS_BACKSCREEN in ('A', 'W') then case 
                                                                       when i.AVAILABILITY_DATE > current date then 'TEMP_OUT_OF_STOCK' 
                                                                       when i.RE_AVAILABLE_DATE > current date then 'TEMP_OUT_OF_STOCK' 
                                                                       else 'AVAILABLE' 
                                                                  end 
              else 'PERM_OUT_OF_STOCK' 
         end availability_status,
         round((cic.BURDENED_COST_CASE_AMT / i.PACK_CASE) + .01, 2) item_cost_price,
         i.PACK_CASE case_Pack_Quantity,
         cic.BURDENED_COST_CASE_AMT case_Pack_Cost_Price,
         case i.WAREHOUSE_CODE 
              when '01' then 'Chilled' 
              when '02' then 'Chilled' 
              when '08' then 'Chilled' 
              when '07' then 'Frozen' 
              else 'Ambient' 
         end temp_type,
         i.RET_UNIT_SIZE,
         i.RET_UNIT_DESC,
         (case i.CODE_DATE_FLAG when 'Y' then 'Shelf Life' else 'Does Not Expire' end) expiration_type,
         (case i.CODE_DATE_FLAG when 'Y' then i.SHELF_LIFE else 365 end) shelf_life,
         i.MERCH_DEPT_DESC,
         i.MERCH_GRP_DESC,
         i.MERCH_CAT_DESC,
         i.MERCH_CLASS_DESC,
         cic.BURDENED_COST_CASE_AMT case_Pack_Cost_burdened,
         i.PURCH_STATUS,
         i.BILLING_STATUS,
         i.BILLING_STATUS_BACKSCREEN,
         i.NATAG_MAINT_DATE,
         i.AVAILABILITY_DATE,
         i.RE_AVAILABLE_DATE,
         case i.CORP_RES 
              when lpad(trim(cic.CORP_SWAT),3,'0') then 'Y' 
              when '000' then 'Y' 
              else 'N' 
         end CORP_AUTH_FLG,
         i.INSITE_FLG,
         i.ITEM_TYPE_CD,
         case 
              when cid.ITEM_AUTH_CD is null then 'Y' 
              else case 
                        when cid.ITEM_AUTH_CD = 'Y' then 'Y' 
                        else 'N' 
                   end 
         end ITEM_AUTH_FLG,
         case 
              when i.PRIVATE_LABEL_KEY = vwcpb.PRIV_BRAND_KEY then 'Y' 
              else case 
                        when i.PRIVATE_LABEL_KEY is null then 'Y' 
                        else 'N' 
                   end 
         end PRIVATE_BRAND_AUTH_FLG
FROM     TABLE( SELECT A.FACILITYID, A.CUSTOMER_NBR_STND, A.BURDENED_COST_FLG, A.CORP_SWAT, A.ITEM_NBR_HS, START_DATE, END_DATE_REAL, BURDENED_COST_CASE_AMT, UNBURDENED_COST_CASE_AMT, BURDENED_COST_CASE_NET_AMT, UNBURDENED_COST_CASE_NET_AMT, OI_ALLOWANCE_START_DATE, OI_ALLOWANCE_END_DATE, OI_ALLOWANCE_AMT, PA_ALLOWANCE_START_DATE, PA_ALLOWANCE_END_DATE, PA_ALLOWANCE_AMT FROM CRMADMIN.V_WEB_CUSTOMER_ITEM_COST A WHERE A.MASTER_ITEM_FLG = 'Y' AND A.CUSTOMER_NBR_STND > 0 AND current date between A.START_DATE and A.END_DATE_REAL ) CIC 
         inner join CRMADMIN.T_WHSE_ITEM i on i.FACILITYID = cic.FACILITYID and i.ITEM_NBR_HS = cic.ITEM_NBR_HS 
         inner join CRMADMIN.T_WHSE_VENDOR v on i.FACILITYID = v.FACILITYID and i.VENDOR_NBR = v.VENDOR_NBR 
         inner join CRMADMIN.V_WEB_CUSTOMER_MDSE_DEPT cmd on i.FACILITYID = cmd.FACILITYID and cmd.CUSTOMER_NBR_STND = cic.CUSTOMER_NBR_STND and i.MERCH_DEPT = cmd.MDSE_DEPT_CD 
         left outer join CRMADMIN.V_WEB_CUSTOMER_PRVT_BRAND vwcpb on i.FACILITYID = vwcpb.FACILITYID and vwcpb.CUSTOMER_NBR_STND = cic.CUSTOMER_NBR_STND and i.PRIVATE_LABEL_KEY = vwcpb.PRIV_BRAND_KEY 
         left outer join CRMADMIN.T_WHSE_ITEM_AUTH cid on cic.FACILITYID = cid.FACILITYID and cid.CUSTOMER_NBR_STND = cic.CUSTOMER_NBR_STND and cic.ITEM_NBR_HS = cid.ITEM_NBR_HS and (cid.EXP_DATE is null or cid.EXP_DATE >= current date) and cid.ITEM_ACTIVE_FLG = 'Y' and cid.ITEM_AUTH_CD <> 'Y' 
         left outer join CRMADMIN.V_AMZ_ASIN asin on i.ROOT_ITEM_NBR = asin.ROOT_ITEM_NBR and i.LV_ITEM_NBR = asin.LV_ITEM_NBR
WHERE    cic.FACILITYID = '015'
AND      cic.CUSTOMER_NBR_STND = 634001
AND      (i.BILLING_STATUS_BACKSCREEN not in ('Z', 'I')
     AND not(i.BILLING_STATUS_BACKSCREEN = 'D'
        AND i.NATAG_MAINT_DATE < current date - 30 days))
AND      case i.CORP_RES when lpad(trim(cic.CORP_SWAT),3,'0') then 'Y' when '000' then 'Y' else 'N' end = 'Y'
AND      i.ITEM_NBR_HS in ('0046193', '0046276', '0046292', '0046474', '0053637', '0053660', '0056523', '0057943', '0069153', '0077321', '0083576', '0083626', '0084186', '0084327', '0084780', '0085670', '0086140', '0091496', '0091579', '0092163', '0092312', '0092346', '0093559', '0097204', '0098376', '0098590', '0099507', '0108985', '0112946', '0115360', '0119719', '0122127', '0122440', '0122515', '0122911', '0125179', '0125310', '0127639', '0128975', '0131243', '0131284', '0137570', '0156125', '0158493', '0158634', '0161604', '0162578', '0166694', '0167528', '0169557', '0172239', '0172981', '0174300', '0175067', '0175182', '0175422', '0181974', '0182055', '0182451', '0182519', '0183525', '0184499', '0185165', '0185553', '0185967', '0186452', '0187096', '0189167', '0196923', '0199919', '0211417', '0211870', '0219550', '0220202', '0221754', '0226902', '0227348', '0228023', '0228064', '0231290', '0232082', '0232173', '0233460', '0235358', '0235408', '0237610', '0238097', '0240804', '0240945', '0241141', '0241422', '0241570', '0241778', '0242883', '0243121', '0246454', '0247668', '024786 ', '0249086', '0249102', '0252833', '0253013', '0256479', '0263426', '0267112', '0268128', '0269746', '0277699', '0277756', '0282566', '0283259', '0284182', '0285593', '0286336', '0286690', '0288985', '0301168', '0302604', '0302992', '0303214', '0303990', '0304014', '0304279', '0305540', '0305987', '0307959', '0317214', '0317669', '0317701', '03178  ', '0320051', '0321836', '0324764', '0326017', '0326439', '0328559', '0328732', '0329169', '0329854', '0332353', '0333799', '0337956', '0339762', '0340976', '0342667', '0344507', '0345116', '0349167', '0349613', '0353763', '0355230', '0355958', '0355966', '0356006', '0356014', '0358184', '0358325', '0360073', '0360081', '0363416', '0363846', '0365395', '0365825', '0365882', '0366237', '0366575', '0370221', '0372417', '0372904', '0380261', '0381467', '0382531', '0387019', '0387167', '0391698', '0392993', '0393389', '0393892', '0395293', '0396457', '0412445', '0425777', '0425900', '0427633', '0430991', '0431486', '0435917', '0435933', '0437244', '0438572', '0440453', '0441196', '0441279', '0443663', '0444547', '0446195', '0446716', '0447425', '0448316', '0451500', '0451732', '0451849', '0451989', '0453647', '0454009', '0456178', '0458208', '0460550', '0460881', '0462879', '0463364', '0465534', '0465609', '0467670', '0469742', '0470955', '0471441', '0472845', '0475830', '0476093', '0476739', '0477190', '0479444', '0483289', '0484527', '0485110', '0485870', '0486274', '0486498', '0486803', '0488999', '0489310', '0489807', '0490128', '0491712', '0491795', '0492066', '0492579', '0492744', '0492777', '0493213', '0493965', '0494468', '0496117', '0496414', '0497339', '0497511', '0498725', '050245 ', '0504142', '0506998', '0508069', '0508721', '0512871', '0512947', '0513267', '0514380', '0515171', '0515817', '0516351', '0518464', '0519355', '0519694', '0519884', '0521351', '0522243', '0525766', '0525782', '0527051', '0528448', '0528497', '0529933', '0536532', '0536607', '0536649', '0537100', '0538066', '0538140', '0538496', '0539635', '0541870', '0542449', '0543579', '0544106', '0544999', '0545285', '0546721', '0546861', '0548222', '0548842', '0550194', '0550459', '0553198', '0555375', '0555607', '0556068', '0556720', '0556803', '0559914', '0560045', '0560631', '0560722', '0561175', '0561522', '0561589', '0563106', '0563734', '0563908', '0564013', '0564054', '0565630', '0565879', '0566216', '0567008', '0568642', '0568733', '0571497', '0576512', '0576603', '0583831', '0583971', '0584755', '0586529', '0587550', '0595900', '0596767', '0598573', '0606079', '0607176', '0608349', '0609289', '0611822', '0612416', '0612721', '0612788', '0613166', '0614859', '0616359', '0617894', '0625723', '0626705', '0631556', '0636795', '0637181', '0640649', '0648352', '0648386', '0650465', '0651976', '0656066', '0656553', '0656785', '0656884', '0658021', '0658310', '0661538', '0661975', '0663146', '0663237', '0672766', '0672832', '0673418', '0674630', '0678094', '0679894', '0681452', '0683417', '0684217', '0684670', '0684696', '0685644', '0686634', '0686709', '0687418', '0688119', '0688531', '0688911', '0689141', '0689414', '0689877', '0689893', '0689943', '0690081', '0691055', '0691071', '0692723', '0697276', '0698555', '0698563', '0698712', '0701730', '0702548', '0704361', '0706663', '0716415', '0716571', '0716688', '0718296', '0721605', '0722108', '0729889', '0731026', '0736231', '0736272', '0736306', '0738823', '0740464', '0740902', '0743401', '0744268', '0747121', '0749366', '0753723', '0753962', '0754085', '0754150', '0754309', '0754499', '0754598', '0755702', '0761189', '0763094', '0763177', '0764019', '0765040', '0767723', '0771451', '0774224', '0782045', '0787903', '0788398', '0794602', '0798660', '0811042', '0811703', '0811760', '0812875', '0815134', '0827428', '0828129', '0829036', '0829150', '0840207')