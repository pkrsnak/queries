-- amazon issue
SELECT   i.FACILITYID, i.ITEM_NBR_HS, asin.LU_CODE asin, asin.ROOT_ITEM_NBR, asin.LV_ITEM_NBR, i.ITEM_DESCRIP, i.PURCH_STATUS, i.BILLING_STATUS_BACKSCREEN
FROM     CRMADMIN.V_AMZ_ASIN asin 
         inner join CRMADMIN.T_WHSE_ITEM i on asin.ROOT_ITEM_NBR = i.ROOT_ITEM_NBR and asin.LV_ITEM_NBR = i.LV_ITEM_NBR
WHERE    asin.LU_CODE in ('B000633ZU8', 'B000BCYD2I', 'B000R2DUXK', 'B001XUXQHA', 'B004BZOFG0', 'B005BYEI44', 'B008X8QOD8', 'B0095M7KOI', 'B00O9XFL5I', 'B00OV5ID1S', 'B00QKY3Y9E', 'B06XQ13DMV', 'B078WFWXHY', 'B07CN8X993', 'B07KYRV4N5', 'B07QLYJYT8', 'B07R81SF9L', 'B07YVYPMQV', 'B0854F8DFP', 'B088Y2N6WC', 'B088Y9CM13', 'B08W3BSQR4', 'B08X6VVKG7', 'B097S76RY5', 'B097S7Q99W', 'B097S86VWJ', 'B0986RDHW3', 'B099BZCJTH', 'B09DL8XXFP', 'B09DM7JSN8', 'B09JJS233X', 'B09K4PLW2L', 'B09K4Q4ZXK', 'B09M31D7XQ', 'B09PM4HXYQ', 'B09PMLFDSL', 'B09RSH53J5', 'B09RSK47V9', 'B09S3YJ9LC', 'B09S538LQG', 'B09S53VDG1', 'B09SVR6WVR', 'B09SVSBT1N')
AND      i.FACILITYID = '015'
;

SELECT   i.FACILITYID,
         i.ITEM_NBR_HS,
         asin.LU_CODE asin,
         asin.ROOT_ITEM_NBR,
         asin.LV_ITEM_NBR,
         i.ITEM_DESCRIP,
         i.PURCH_STATUS,
         i.BILLING_STATUS_BACKSCREEN,
         cic.BURDENED_COST_CASE_NET_AMT
FROM     CRMADMIN.V_AMZ_ASIN asin 
         inner join CRMADMIN.T_WHSE_ITEM i on asin.ROOT_ITEM_NBR = i.ROOT_ITEM_NBR and asin.LV_ITEM_NBR = i.LV_ITEM_NBR 
         left join TABLE( SELECT A.FACILITYID, A.CUSTOMER_NBR_STND, A.BURDENED_COST_FLG, A.CORP_SWAT, A.ITEM_NBR_HS, START_DATE, END_DATE_REAL, BURDENED_COST_CASE_AMT, UNBURDENED_COST_CASE_AMT, BURDENED_COST_CASE_NET_AMT, UNBURDENED_COST_CASE_NET_AMT, OI_ALLOWANCE_START_DATE, OI_ALLOWANCE_END_DATE, OI_ALLOWANCE_AMT, PA_ALLOWANCE_START_DATE, PA_ALLOWANCE_END_DATE, PA_ALLOWANCE_AMT FROM CRMADMIN.V_WEB_CUSTOMER_ITEM_COST A WHERE A.MASTER_ITEM_FLG = 'Y' AND A.CUSTOMER_NBR_STND = 634001 AND current date between A.START_DATE and A.END_DATE_REAL ) CIC on i.FACILITYID = cic.FACILITYID and i.ITEM_NBR_HS = cic.ITEM_NBR_HS
WHERE    asin.LU_CODE in ('B000633ZU8', 'B000BCYD2I', 'B000R2DUXK', 'B001XUXQHA', 'B004BZOFG0', 'B005BYEI44', 'B008X8QOD8', 'B0095M7KOI', 'B00O9XFL5I', 'B00OV5ID1S', 'B00QKY3Y9E', 'B06XQ13DMV', 'B078WFWXHY', 'B07CN8X993', 'B07KYRV4N5', 'B07QLYJYT8', 'B07R81SF9L', 'B07YVYPMQV', 'B0854F8DFP', 'B088Y2N6WC', 'B088Y9CM13', 'B08W3BSQR4', 'B08X6VVKG7', 'B097S76RY5', 'B097S7Q99W', 'B097S86VWJ', 'B0986RDHW3', 'B099BZCJTH', 'B09DL8XXFP', 'B09DM7JSN8', 'B09JJS233X', 'B09K4PLW2L', 'B09K4Q4ZXK', 'B09M31D7XQ', 'B09PM4HXYQ', 'B09PMLFDSL', 'B09RSH53J5', 'B09RSK47V9', 'B09S3YJ9LC', 'B09S538LQG', 'B09S53VDG1', 'B09SVR6WVR', 'B09SVSBT1N')
AND      i.FACILITYID = '015'
;


--caito issue
SELECT   FACILITY_ID, ACTUAL_SHIP_DT, sum(SHIP_UNIT_QTY) shipped 
FROM     WH_OWNER.CAITO_SALES_HST
group by FACILITY_ID, ACTUAL_SHIP_DT

--amazon issue 2:

SELECT   shd.CUSTOMER_NBR_STND,
         sum(shd.QTY_SOLD - shd.QTY_SCRATCHED) qty_shipped,
         sum((shd.QTY_SOLD - shd.QTY_SCRATCHED) * i.PACK_CASE) units_shipped,
         sum((shd.QTY_SOLD - shd.QTY_SCRATCHED) * shd.STORE_PACK ) units_shipped_2
FROM     CRMADMIN.T_WHSE_SALES_HISTORY_DTL shd 
         inner join CRMADMIN.T_WHSE_ITEM i on i.FACILITYID = shd.FACILITYID and i.ITEM_NBR_HS = shd.ITEM_NBR_HS
WHERE    shd.CUSTOMER_NBR_STND between 634000 and 634999
AND      shd.BILLING_DATE between '2022-03-01' and '2022-04-14'
GROUP BY shd.CUSTOMER_NBR_STND
;



SELECT   dsh.CUSTOMER_NBR,
         sum(dsh.SHIPPED_QTY) qty_shipped,
         sum(dsh.SHIPPED_QTY * i.CASE_PACK_QTY) units_shipped
FROM     WH_OWNER.DC_SALES_HST dsh 
         inner join WH_OWNER.DC_ITEM i on i.FACILITY_ID = dsh.FACILITY_ID and i.ITEM_NBR = dsh.ITEM_NBR
WHERE    dsh.CUSTOMER_NBR between 634000 and 634999
AND      dsh.TRANSACTION_DATE between '2022-03-01' and '2022-04-14'
GROUP BY dsh.CUSTOMER_NBR