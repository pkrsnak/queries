SELECT   v.FACILITYID,
         v.VENDOR_NBR,
         v.VENDOR_NAME,
         v.STATUS,
         v.VENDOR_TYPE,
         v.PROCESS_TIMESTAMP,
         v.CREATE_DATE,
         v.LAST_MAINT_DATE,
         v.MASTER_VENDOR,
         v.MASTER_VENDOR_DESC,
         sum(case when i.PURCH_STATUS not in ('D', 'Z') then 1 else 0 end) num_items
FROM     CRMADMIN.T_WHSE_VENDOR v 
         left outer join CRMADMIN.T_WHSE_ITEM i on i.FACILITYID = v.FACILITYID and i.VENDOR_NBR = v.VENDOR_NBR
WHERE    (v.FACILITYID = '040'
     AND v.VENDOR_NBR in ( '000895', '005325', '000423', '005335', '000122', '000777', '002039', '072564', '001997', '002400', '002401', '099432', '089120', '003083', '003556', '005336', '009278', '000248', '000518', '000565', '000587', '043078', '043082', '091772', '027805', '068140', '000472', '005320', '051938', '004622', '086128', '067999', '043084', '004540', '001998', '005549', '002600', '005990', '005880', '099325', '001530', '000604', '001111', '000333', '000424', '884023', '880423', '988988')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '001'
     AND v.VENDOR_NBR in ('900709', '006637', '009202', '011489', '011803', '012492', '013720', '015107', '015108', '015109', '015110', '015111', '015340', '017778', '017779', '017780', '017839', '018155', '018156', '018157', '018158', '018159', '018289', '018332', '018603', '018664', '018684', '018685', '018700', '018703', '018706', '018708', '018709', '018711', '018712', '018715', '018717', '018718', '018724', '018725', '018730', '018732', '018734', '018735', '018737', '018770', '018905', '018978', '018983', '019046', '019192', '019683', '019745', '019762', '019847', '019850', '019851', '019853', '019854', '019855', '019856', '019857', '019858', '019859', '019860', '019861', '019863', '019865', '019869', '019872', '019875', '019876', '019877', '019878', '019879', '019880', '019881', '019882', '019883', '019886', '019887', '019888', '019891', '019892', '019893', '019897', '019899', '019900', '019930', '020017', '020124', '020675', '020677', '020953', '021206', '021257', '021420', '017420', '019849', '884023', '016638', '988988')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '002'
     AND v.VENDOR_NBR in ('073331', '050400', '003221', '003556', '884023', '170943')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '003'
     AND v.VENDOR_NBR in ('030152', '000895', '012500', '009724', '061792', '067999', '001008', '001438', '083550', '004151', '003221', '001362', '884023', '988988')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '008'
     AND v.VENDOR_NBR in ('064453', '000250', '000035', '064442', '000244', '884023', '880423', '988988')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '015'
     AND v.VENDOR_NBR in ('900709', '009054', '009137', '009026', '009129', '000196', '003666', '003129', '009040', '009015', '001578', '009081', '009085', '884023')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '054'
     AND v.VENDOR_NBR in ('900709', '050025')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '058'
     AND v.VENDOR_NBR in ('900709', '884023')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '061'
     AND v.VENDOR_NBR in ('044591', '162463', '140011', '140669', '141091', '269053', '452095', '654540', '463299', '463531', '092180', '050806', '081251', '050164', '062462', '050824', '062889', '062991', '111422', '022320', '031933', '049204', '049255', '172641', '313055', '349913', '287111', '312671', '359988', '171913', '182951', '031934', '067341', '131882', '146565', '171242', '303251', '399573', '463371', '082061', '054361', '012281', '013252', '131961', '141411', '049166', '089071', '142102', '173264', '024463', '130980', '050709', '172051', '349593', '350841', '463451')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '071'
     AND v.VENDOR_NBR in ('900709', '884023', '170943')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
OR       (v.FACILITYID = '085'
     AND v.VENDOR_NBR in ('898933')
)--     AND i.PURCH_STATUS not in ('D', 'Z'))
GROUP BY v.FACILITYID,
         v.VENDOR_NBR,
         v.VENDOR_NAME,
         v.STATUS,
         v.VENDOR_TYPE, 
         v.PROCESS_TIMESTAMP,
         v.CREATE_DATE, 
         v.LAST_MAINT_DATE,
         v.MASTER_VENDOR, 
         v.MASTER_VENDOR_DESC
;



SELECT   FACILITYID,
         VENDOR_NBR,
         VENDOR_NAME,
         VENDOR_GROUP,
         STATUS,
         VENDOR_TYPE,
         PROCESS_TIMESTAMP,
         CREATE_DATE
FROM     CRMADMIN.T_WHSE_VENDOR
WHERE    FACILITYID = '040'
AND      VENDOR_NBR in ('000895', '005325', '000423', '005335', '000122', '000777', '002039', '072564', '001997', '002400', '002401', '099432', '089120', '003083', '003556', '005336', '009278', '000248', '000518', '000565', '000587', '043078', '043082', '091772', '027805', '068140', '000472', '005320', '051938', '004622', '086128', '067999', '043084', '004540', '001998', '005549', '002600', '005990', '005880', '099325', '001530', '000604', '001111', '000333', '000424', '884023', '880423', '988988')
;
